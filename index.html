<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>some title</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <!--optional color scales, you can specify your own color scale-->
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <!-- <script type="text/javascript" src="assets/script/script.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        .dashed_grid line {
            stroke: #d3d3d3;
            stroke-dasharray: 5,5;
        }
    </style>
</head>

<body>
    <div class="tooltip"></div>
    <section id="s-0" class="full-color-bg">
        <div class="container">
            <div class="row">
                <div class="col-sm-6">
                    <h1 class="lg-headline">High level insight</h1>
                    <p class="lg-subtext">Here is some info about a really cool insight we found. Use our visualization to gain insights into how to better strategize your campaign.</p>
                </div>
                <div class="col-sm-6">
                    <div class="stat-container">
                        <div class="stat-val">75%</div>
                        <div class="stat-label">label</div>
                    </div>
                </div>

            </div>
        </div>
        <a href="#s-1" id="s0-next-btn" class="btn-next white" onclick="drawChart1()">next</a>
        <!-- <svg class="chart1"></svg> -->
    </section>
    <section id="s-1">
        <div class="row">
            <h2>Does your audience Believe Global Warming is Happening?</h2>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <p>Let’s say you are have a Republican running for President, and they are about to go on a tour of the nation. They need to know a bit about the states they are visiting, and you need to curate their speeches in each state. Let’s look at who believes global warming is happening. You can see that most of the Republicans in each state are on the same page -- hovering around 50%. There are some outliers though, with New York, New Jersey, Hawaii, California, and Alaska sitting closer to 60%. Interestingly, 4 of these 5 states have a major industry of Healthcare and Social Assistance. Let’s explore this further.</p>
            </div>
            <div class="col-sm-9">
                <svg class="chart1"></svg>
            </div>
        </div>
        <a href="#s-2" id="s1-next-btn" class="btn-next" onclick="drawChart2()">next</a>
    </section>

    <section id="s-2">
        <div class="row">
            <h2>If they do, are they worried about it?</h2>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <p>The five states we looked at earlier are also worried about global warming. Perhaps when your candidate visits this state, they should discuss how their policies will begin to reverse global warming. The remaining states did not have high percentages of people who believed that global warming is happening, and concordantly do not have high levels of worry. In these states, you might choose to emphasize other stances of the platform, rather than spending time discussing the action your candidate will take regarding policies surrounding global warming.</p>
            </div>
            <div class="col-sm-6">
                <svg class="chart2"></svg>
            </div>
        </div>
        <a href="#s-3" id="s2-next-btn" class="btn-next" onclick="drawChart3()">next</a>
    </section>

    <section id="s-3">
        <div class="row">
            <h2>What are their opinions about regulating CO2? Should you emphasize that in your speech?</h2>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <p>New York and New Jersey are two states where the regulation of CO2 matters to them. In these states, it might be a good topic for the candidate to discuss in order to gain support and votes. Other states still have fairly high rates of support, but in New York and New Jersey, addressing this topic could make a more significant difference in the eventual election. </p>
            </div>
            <div class="col-sm-6">
                <svg class="chart3"></svg>
            </div>
        </div>
        <a href="#s-4" id="s3-next-btn" class="btn-next" onclick="drawChart4()">next</a>
    </section>

    <section id="s-4">
        <div class="row">
            <p>Explore on your own -- What issues is your candidate concerned with? Which states are you visiting?</p>
            <div class="btn-group" role="group" id="buttons-2">
                <button id="democrat-btn-2" class="btn active" onclick="showcontrols(this)">Democrats</button>
                <button id="republican-btn-2" class="btn" onclick="showcontrols(this)">Republicans</button>
            </div>
        </div>
        <div id="controls">
            <p class="textlabel">Select variable to view:</p>
            <select id="select_list" onchange="checkactive()">
                <option value="happening">Believe global warming is happening</option>
                <option value="human">Believe global warming is caused by human activity</option>
                <option value="harmUS">Believe global warming will harm US</option>
                <option value="regulate">Support regulating CO2 as a pollutant</option>
                <option value="supportRPS">Support producing 20% electricity from renewable sources</option>
                <option value="fundrenewables">Support funding research for renewable energy sources</option>
                <option value="consensus">Believe most scientists believe global warming is happening</option>
                <option value="worried">Worried about global warming</option>
            </select>
            <div class="tooltip"></div>
        </div>
        <svg class="chart4"></svg>
        <svg class="chart5"></svg>
    </section>

    <script>
    var margin = {top: 50 , right: 50, bottom: 100, left: 20}
    var t = d3.transition().duration(3000)
    var tooltip = d3.select(".tooltip")
    window.colorscaleR=d3.scaleOrdinal().range(["#f699e7", "#E95900","#F6D903", "#BB7F0A"])
    window.colorscaleD=d3.scaleOrdinal().range(["#00BFFF", "#43AA8B","#B784E7", "#5F4BB6"])


    d3.json("assets/json/climate_data_long.json", function(error,data) {
        // console.log(data)
        window.nested_data = d3.nest().key((d)=>d.Group).entries(data)
        dem = nested_data[0].values
        rep = nested_data[1].values
        drawChart4(dem,colorscaleD)
        drawChart5(dem,colorscaleD)
    });

    function showcontrols(element) {
        if (element.id == 'democrat-btn-2') {
            drawChart4(dem,colorscaleD)
        }
        else if(element.id=='republican-btn-2') {
            drawChart4(rep,colorscaleR)
        }
    }

    function checkactive () {
        var rep_btn= $('#republican-btn-2');
        var dem_btn= $('#democrat-btn-2')
        if (rep_btn.hasClass('active')) {
            console.log("rep active")
            drawChart4(rep,colorscaleR)
        }
        else if (dem_btn.hasClass('active')) {
            console.log("dem active")
            drawChart4(dem,colorscaleD)
        }
    }

    function drawChart1() {
        var width = 0.75*window.innerWidth - margin.left - margin.right
        var height = 400
        var chartWidth = 0.8*width

        var x = d3.scaleBand().range([0, chartWidth]).padding(0.1)
        var y = d3.scaleLinear().range([height, 0])
        var sizeScale = d3.scaleLinear().range([5, 10])

        var chart = d3.select(".chart1")
                    .attr("width", width)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")

        var title = chart.append("text")
                    .attr("x", (chartWidth/2))
                    .attr("y", margin.top/2)
                    .attr("text-anchor", "middle")
                    .attr("class","chartTitle")
                    .style("font-size", "24px")
                    .style("font-family","Raleway")
                    .style("font-weight", 700)
                    .text("Republicans' belief that global warming is happening")

        viz_data=nested_data[1].values

        x.domain(viz_data.map((d) => d.GeoName))
        y.domain([0,100])

        sizeScale.domain([0,d3.max(viz_data, (d) => d.Electoral_Votes)])
        colorscaleR.domain(["Manufacturing", "Health care and social assistance" , "Retail trade", "Accommodation and food services"])

        var circle = chart.selectAll('circle.dot')
            .data(viz_data);

        //exit
        circle.exit()
        .transition()
        .attr('cx',0)
        .attr('cy',0)
        .remove()

        //update
        circle.attr("r",0).transition()
        .attr('cy', function(d) { return y(d.happening)})
        .attr('r', (d) => sizeScale(d.Electoral_Votes))
        .attr("fill", (d) => colorscaleR(d.Industry));

        //enter
        circle.enter().append("circle")
        .attr("class","dot")
        .attr("transform", "translate(38,0)")
        .attr('cx', (d) =>  x(d.GeoName))
        .attr('cy', function(d) { return y(d.happening) })
        .attr('r',0)
        .transition()
        .attr('r', (d) => sizeScale(d.Electoral_Votes))
        .attr("fill", (d) => colorscaleR(d.Industry));
        //enter & update
        chart.selectAll("circle.dot")
        .on("mouseover", function(d) {
            tooltip.transition()
            .style("opacity", .9)
            tooltip.text("Happening: " + d.happening)
            .style("left", (d3.event.pageX) + "px")
            .style("top", (d3.event.pageY - 28) + "px")
            tooltip.append("tspan").attr("class","label").text("Electoral Votes: " + d.Electoral_Votes)
            tooltip.append("tspan").attr("class","label").text("State: " + d.GeoName)
            tooltip.append("tspan").attr("class","label").text("Industry: " + d.Industry)
        })
        .on("mouseout", (d) => tooltip.transition().style("opacity", 0))

        // x-axis
        chart.append("g")
            .attr("transform", "translate(30," + (height+10) + ")")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisBottom(x))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", "-.1em")
            .attr("transform", "rotate(-65)");

        // y-axis
        chart.append("g")
            .attr("transform", "translate(30,10)")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisLeft(y))

        var gridlines = d3.axisTop()
                        .tickFormat("")
                        .tickSize(height)
                        .scale(x)
        chart.append("g")
        .attr("class","dashed_grid")
        .attr("transform", "translate(30," + (height+10) + ")")
        .call(gridlines)

        // createLegend
        var legend = d3.select(".chart1")
                .append("g")
                .attr("transform","translate(" + (chartWidth + margin.left + margin.right) + ",0)")
                .selectAll("g")
                .data(colorscaleR.domain())

        legend.enter().append('circle')
            .attr('cx', 10)
            .attr('cy', 12)
            .attr('r', 10)
            .attr("transform", (d,i) => "translate(0," + 30*i + ")")
            .style('fill', colorscaleR)
            .style('stroke', colorscaleR);

        legend.enter().append('text')
            .attr('x', 25)
            .attr('y', 16)
            .attr("class", "legendText")
            .attr("transform",(d,i) => "translate(0," + 30*i + ")")
            .text((d) => d )
    }

    function drawChart2() {
        var width = 0.75*window.innerWidth - margin.left - margin.right
        var height = 400
        var chartWidth = 0.8*width

        var x = d3.scaleBand().range([0, chartWidth]).padding(0.1)
        var y = d3.scaleLinear().range([height, 0])
        var sizeScale = d3.scaleLinear().range([5, 10])

        var chart = d3.select(".chart2")
                    .attr("width", width)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")

        var title = chart.append("text")
                    .attr("x", (chartWidth/2))
                    .attr("y", margin.top/2)
                    .attr("text-anchor", "middle")
                    .attr("class","chartTitle")
                    .style("font-size", "24px")
                    .style("font-family","Raleway")
                    .style("font-weight", 700)
                    .text("Republicans worried about global warming")

        viz_data=nested_data[1].values

        x.domain(viz_data.map((d) => d.GeoName))
        y.domain([0,100])

        sizeScale.domain([0,d3.max(viz_data, (d) => d.Electoral_Votes)])
        colorscaleR.domain(["Manufacturing", "Health care and social assistance" , "Retail trade", "Accommodation and food services"])

        var circle = chart.selectAll('circle.dot')
            .data(viz_data);

        //exit
        circle.exit()
                .transition()
                .attr('cx',0)
                .attr('cy',0)
                .remove()

        //update
        circle.attr("r",0).transition()
                .attr('cy', function(d) { return y(d.worried)})
                .attr('r', (d) => sizeScale1(d.Electoral_Votes))
                .attr("fill", (d) => colorscaleR(d.Industry));

        //enter
        circle.enter().append("circle")
                .attr("class","dot")
                .attr("transform", "translate(38,0)")
                .attr('cx', (d) =>  x(d.GeoName))
                .attr('cy', function(d) { return y(d.worried) })
                .attr('r',0)
                .transition()
                .attr('r', (d) => sizeScale(d.Electoral_Votes))
                .attr("fill", (d) => colorscaleR(d.Industry));
        //enter & update
        chart.selectAll("circle.dot")
                .on("mouseover", function(d) {
                    tooltip.transition()
                    .style("opacity", .9)
                    tooltip.text("Happening: " + d.worried)
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY - 28) + "px")
                    tooltip.append("tspan").attr("class","label").text("Electoral Votes: " + d.Electoral_Votes)
                    tooltip.append("tspan").attr("class","label").text("State: " + d.GeoName)
                    tooltip.append("tspan").attr("class","label").text("Industry: " + d.Industry)
                })
                .on("mouseout", (d) => tooltip.transition().style("opacity", 0))

        // x-axis
        chart.append("g")
            .attr("transform", "translate(30," + (height+10) + ")")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisBottom(x))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", "-.1em")
            .attr("transform", "rotate(-65)");

        // y-axis
        chart.append("g")
            .attr("transform", "translate(30,10)")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisLeft(y))

        var gridlines = d3.axisTop()
                        .tickFormat("")
                        .tickSize(height)
                        .scale(x)
        chart.append("g")
        .attr("class","dashed_grid")
        .attr("transform", "translate(30," + (height+10) + ")")
        .call(gridlines)

        // createLegend
        var legend = d3.select(".chart2")
                .append("g")
                .attr("transform","translate(" + (chartWidth + margin.left + margin.right) + ",0)")
                .selectAll("g")
                .data(colorscaleR.domain())

        legend.enter().append('circle')
            .attr('cx', 10)
            .attr('cy', 12)
            .attr('r', 10)
            .attr("transform", (d,i) => "translate(0," + 30*i + ")")
            .style('fill', colorscaleR)
            .style('stroke', colorscaleR);

        legend.enter().append('text')
            .attr('x', 25)
            .attr('y', 16)
            .attr("class", "legendText")
            .attr("transform",(d,i) => "translate(0," + 30*i + ")")
            .text((d) => d )
    }

    function drawChart3() {
        var width = 0.75*window.innerWidth - margin.left - margin.right
        var height = 400
        var chartWidth = 0.8*width

        var x = d3.scaleBand().range([0, chartWidth]).padding(0.1)
        var y = d3.scaleLinear().range([height, 0])
        var sizeScale = d3.scaleLinear().range([5, 10])

        var chart = d3.select(".chart3")
                    .attr("width", width)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")

        var title = chart.append("text")
                    .attr("x", (chartWidth/2))
                    .attr("y", margin.top/2)
                    .attr("text-anchor", "middle")
                    .attr("class","chartTitle")
                    .style("font-size", "24px")
                    .style("font-family","Raleway")
                    .style("font-weight", 700)
                    .text("Republicans support for regulating CO2 as a pollutant")

        viz_data=nested_data[1].values

        x.domain(viz_data.map((d) => d.GeoName))
        y.domain([0,100])

        sizeScale.domain([0,d3.max(viz_data, (d) => d.Electoral_Votes)])
        colorscaleR.domain(["Manufacturing", "Health care and social assistance" , "Retail trade", "Accommodation and food services"])

        var circle = chart.selectAll('circle.dot')
            .data(viz_data);

        //exit
        circle.exit()
                .transition()
                .attr('cx',0)
                .attr('cy',0)
                .remove()

        //update
        circle.attr("r",0).transition()
                .attr('cy', function(d) { return y(d.regulate)})
                .attr('r', (d) => sizeScale1(d.Electoral_Votes))
                .attr("fill", (d) => colorscaleR(d.Industry));

        //enter
        circle.enter().append("circle")
                .attr("class","dot")
                .attr("transform", "translate(38,0)")
                .attr('cx', (d) =>  x(d.GeoName))
                .attr('cy', function(d) { return y(d.regulate) })
                .attr('r',0)
                .transition()
                .attr('r', (d) => sizeScale(d.Electoral_Votes))
                .attr("fill", (d) => colorscaleR(d.Industry));
        //enter & update
        chart.selectAll("circle.dot")
                .on("mouseover", function(d) {
                    tooltip.transition()
                    .style("opacity", .9)
                    tooltip.text("Happening: " + d.regulate)
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY - 28) + "px")
                    tooltip.append("tspan").attr("class","label").text("Electoral Votes: " + d.Electoral_Votes)
                    tooltip.append("tspan").attr("class","label").text("State: " + d.GeoName)
                    tooltip.append("tspan").attr("class","label").text("Industry: " + d.Industry)
                })
                .on("mouseout", (d) => tooltip.transition().style("opacity", 0))

        // x-axis
        chart.append("g")
            .attr("transform", "translate(30," + (height+10) + ")")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisBottom(x))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", "-.1em")
            .attr("transform", "rotate(-65)");

        // y-axis
        chart.append("g")
            .attr("transform", "translate(30,10)")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisLeft(y))

        var gridlines = d3.axisTop()
                        .tickFormat("")
                        .tickSize(height)
                        .scale(x)
        chart.append("g")
        .attr("class","dashed_grid")
        .attr("transform", "translate(30," + (height+10) + ")")
        .call(gridlines)

        // createLegend
        var legend = d3.select(".chart2")
                .append("g")
                .attr("transform","translate(" + (chartWidth + margin.left + margin.right) + ",0)")
                .selectAll("g")
                .data(colorscaleR.domain())

        legend.enter().append('circle')
            .attr('cx', 10)
            .attr('cy', 12)
            .attr('r', 10)
            .attr("transform", (d,i) => "translate(0," + 30*i + ")")
            .style('fill', colorscaleR)
            .style('stroke', colorscaleR);

        legend.enter().append('text')
            .attr('x', 25)
            .attr('y', 16)
            .attr("class", "legendText")
            .attr("transform",(d,i) => "translate(0," + 30*i + ")")
            .text((d) => d )
    }

    function drawChart4(data,color) {
        var width = window.innerWidth - margin.left - margin.right
        var height = 500 - margin.top - margin.bottom
        var chartWidth = 0.8*width

        var x = d3.scaleBand().range([0, chartWidth]).padding(0.1)
        var y = d3.scaleLinear().range([height, 0])
        var sizeScale = d3.scaleLinear().range([5, 15])

        var chart = d3.select(".chart4")
                    .attr("width", width)
                    .attr("height", height + margin.top + margin.bottom)

        var title = chart.append("g")
                    .append("text")
                    .attr("x", (chartWidth/2))
                    .attr("y", margin.top/2)
                    .attr("text-anchor", "middle")
                    .attr("class","chartTitle")
                    .style("font-size", "24px")
                    .style("font-family","Raleway")
                    .style("font-weight", 700)

        window.selected = d3.select("#select_list").property("value")
        // name = document.getElementById('select_list').options[document.getElementById('select_list').selectedIndex].text
        // title.text(name);

        x.domain(data.map((d) => d.GeoName))
        y.domain([0,100])
        sizeScale.domain([0,d3.max(data, (d) => d.Electoral_Votes)])
        color.domain(["Manufacturing", "Health care and social assistance" , "Retail trade", "Accommodation and food services"])

        var circle = chart.selectAll('circle.dot')
                        .data(data)

        //exit
        circle.exit()
            .transition()
            .attr('cx',0)
            .attr('cy',0)
            .remove()

        //update
        circle.attr("r",0).transition()
            .attr('cy', function(d) {
                if (selected == 'regulate') {
                    return y(d.regulate);
                }
                else if (selected == 'supportRPS') {
                    return y(d.supportRPS);
                }
                else if (selected == 'fundrenewables') {
                    return y(d.fundrenewables);
                }
                else if (selected == 'happening') {
                    return y(d.happening)
                }
                else if (selected == 'human') {
                    return y(d.human)
                }
                else if (selected == 'consensus') {
                    return y(d.consensus)
                }
                else if (selected == 'worried') {
                    return y(d.worried)
                }
                else if (selected == 'harmUS') {
                    return y(d.harmUS)
                }
            })
            .attr('r', (d) => sizeScale(d.Electoral_Votes))
            .attr("fill", (d) => color(d.Industry))

        //enter
        circle.enter().append("circle")
            .attr("class","dot")
            .attr("transform", "translate(40,20)")
            .attr('cx', (d) =>  x(d.GeoName))
            .attr('cy', function(d) {
                if (selected == 'regulate') {
                    return y(d.regulate)
                }
                else if (selected == 'supportRPS') {
                    return y(d.supportRPS)
                }
                else if (selected == 'fundrenewables') {
                    return y(d.fundrenewables);
                }
                else if (selected == 'happening') {
                    return y(d.happening)
                }
                else if (selected == 'human') {
                    return y(d.human)
                }
                else if (selected == 'consensus') {
                    return y(d.consensus)
                }
                else if (selected == 'worried') {
                    return y(d.worried)
                }
                else if (selected == 'harmUS') {
                    return y(d.harmUS)
                }
            })
            .attr('r',0)
            .transition()
            .attr('r', (d) => sizeScale(d.Electoral_Votes))
            .attr("fill", (d) => color(d.Industry))
            // .attr("transform","translate(10,0)");

        //enter & update
        chart.selectAll("circle.dot")
                    .on("mouseover", function(d) {
                        tooltip.transition()
                        .style("opacity", .9);
                        if (selected == 'regulate') {
                            tooltip.text("Regulate: " + d.regulate)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'supportRPS') {
                            tooltip.text("SupportRPS: " + d.supportRPS)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'fundrenewables') {
                            tooltip.text("Fund Renewable: " + d.fundrenewables)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'happening') {
                            tooltip.text("Happening: " + d.happening)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'human') {
                            tooltip.text("Human: " + d.human)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'consensus') {
                            tooltip.text("Consensus: " + d.consensus)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'worried') {
                            tooltip.text("Worried: " + d.worried)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        else if (selected == 'harmUS') {
                            tooltip.text("Harm US: " + d.harmUS)
                            .style("left", (d3.event.pageX) + "px")
                            .style("top", (d3.event.pageY - 28) + "px");
                        }
                        tooltip.append("tspan").attr("class","label").text("Electoral Votes: " + d.Electoral_Votes)
                        tooltip.append("tspan").attr("class","label").text("State: " + d.GeoName)
                        tooltip.append("tspan").attr("class","label").text("Industry: " + d.Industry)
                    })
                    .on("mouseout", (d) => tooltip.transition().style("opacity", 0))

        // x-axis
        chart.append("g")
            .attr("transform", "translate(30," + (height+20) + ")")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisBottom(x))
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("dx", "-.8em")
            .attr("dy", "-.1em")
            .attr("transform", "rotate(-65)");

        // y-axis
        chart.append("g")
            .attr("transform", "translate(30,20)")
            .style("font-family","Raleway")
            .style("font-size", "11px")
            .call(d3.axisLeft(y))

        //gridlines
        var gridlines = d3.axisTop()
                        .tickFormat("")
                        .tickSize(height)
                        .scale(x)
        chart.append("g")
        .attr("class","dashed_grid")
        .attr("transform", "translate(30," + (height+20) + ")")
        .call(gridlines)

        //legend
        var legend = d3.select(".chart4")
                .append("g")
                .attr("transform","translate(" + (chartWidth + margin.left + margin.right) + ",0)")
                .selectAll("g")
                .data(color.domain())

        legend.enter().append('circle')
            .attr('cx', 10)
            .attr('cy', 12)
            .attr('r', 10)
            .attr("transform", (d,i) => "translate(0," + 30*i + ")")
            .style('fill', color)
            .style('stroke', color);

        legend.enter().append('text')
            .attr('x', 25)
            .attr('y', 16)
            .attr("class", "legendText")
            .attr("transform",(d,i) => "translate(0," + 30*i + ")")
            .text((d) => d )
    }

    function drawChart5(data,color) {
        var height = 3100 - margin.top - margin.bottom
        var width = window.innerWidth - margin.left - margin.right
        var chartwidth=width/5
        var chartheight=200

        var x = d3.scaleBand().rangeRound([0, chartwidth-margin.left-margin.left]).padding([0.1]);
        var y = d3.scaleLinear().range([chartheight, 0]);

        var chart = d3.select(".chart5")
                    .attr("width", width)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")

        chart.append("text")
            .attr("x", width/2)
            .attr("y", margin.top/2)
            .attr("text-anchor", "middle")
            .style("font-size", "24px")
            .style("font-family","Raleway")
            .style("font-weight", 500)
            .text("Chart title");

        var opinions = ["regulate","supportRPS", "happening", "human", "harmUS", "consensus", "fundrenewables", "worried"]
        var barWidth = (chartwidth-margin.left-margin.left)/opinions.length;

        x.domain(opinions)
        y.domain([0, 100])//Math.max(d3.max(data, d => d.Worldwide_Gross), d3.max(data, d => d.US_Gross))]);

        var bars1 = chart.selectAll(".bar").data(data)
                    .enter().append("g")
                    .attr("class", "bar")
                    .attr("transform", function(d, i) {
                        return "translate(" + (10+margin.left+((i%5)*chartwidth)) + "," + (margin.top+((Math.floor(i/5))*(chartheight+margin.top+50))) + ")";
                    })
                    .append("rect")
                    .attr("y", function(d) { return y(d.regulate); })
                    .attr("height", function(d,i) { return chartheight - y(d.regulate); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "orange")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.regulate)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })

        var bars2 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+barWidth+",0)")
                    .attr("y", function(d) { return y(d.supportRPS); })
                    .attr("height", function(d,i) { return chartheight - y(d.supportRPS); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "green")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.supportRPS)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })

        var bars3 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+2*barWidth+",0)")
                    .attr("y", function(d) { return y(d.happening); })
                    .attr("height", function(d,i) { return chartheight - y(d.happening); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "red")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.happening)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })
        var bars4 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+3*barWidth+",0)")
                    .attr("y", function(d) { return y(d.human); })
                    .attr("height", function(d,i) { return chartheight - y(d.human); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "blue")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.human)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })
        var bars5 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+4*barWidth+",0)")
                    .attr("y", function(d) { return y(d.harmUS); })
                    .attr("height", function(d,i) { return chartheight - y(d.harmUS); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "yellow")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.harmUS)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })
        var bars6 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+5*barWidth+",0)")
                    .attr("y", function(d) { return y(d.consensus); })
                    .attr("height", function(d,i) { return chartheight - y(d.consensus); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "pink")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.consensus)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })
        var bars7 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+6*barWidth+",0)")
                    .attr("y", function(d) { return y(d.fundrenewables); })
                    .attr("height", function(d,i) { return chartheight - y(d.fundrenewables); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "gray")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.fundrenewables)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })
        var bars8 = chart.selectAll(".bar")
                    .append("rect")
                    .attr("transform","translate("+7*barWidth+",0)")
                    .attr("y", function(d) { return y(d.worried); })
                    .attr("height", function(d,i) { return chartheight - y(d.worried); })
                    .attr("width",barWidth - 1)
                    .attr("fill", "purple")
                    .on("mouseover", function(d) {
                    tooltip.transition().style("opacity", .9);
                    tooltip.text(d.worried)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function (d) {
                        tooltip.style("opacity", 0);
                    })


        // x-axis for chart 2
        chart.selectAll(".bar").append("g")
        .attr("transform", function(d, i) {
            return "translate(0," + chartheight + ")";
        })
        .style("font-family","Raleway")
        .style("font-size", "11px")
        .call(d3.axisBottom(x))
        .selectAll("text")
        .style("text-anchor", "end")
        .attr("dx", "-.8em")
        .attr("dy", "-.1em")
        .attr("transform", "rotate(-65)");

        // y-axis for chart 2
        chart.selectAll(".bar").append("g")
        .style("font-family","Raleway")
        .style("font-size", "12px")
        .call(d3.axisLeft(y));

        // label
        chart.selectAll(".bar").append("text")
            .attr("x", (chartwidth-margin.left)/2)
            .attr("y", 0)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("font-family","Raleway")
            .style("font-weight", 700)
            .text(function(d) {return d.GeoName})
    }



    // UI STUFF

    var rep2_btn = $('#republican-btn-2');
    var dem2_btn = $('#democrat-btn-2');

    rep2_btn.click(function(e) {
        console.log("rep2 clicked");
        dem2_btn.removeClass("active");
        rep2_btn.toggleClass("active");

    });

    dem2_btn.click(function(e) {
        console.log("dem2 clicked");
        rep2_btn.removeClass("active");
        dem2_btn.toggleClass("active");

    });

    $("#s0-next-btn").click(function(e) {
        e.preventDefault();
        $('html, body').animate({
            scrollTop: $("#s-1").offset().top
        }, 500);
    });

    $("#s1-next-btn").click(function(e) {
        e.preventDefault();
        $('html, body').animate({
            scrollTop: $("#s-2").offset().top
        }, 500);
    });

    $("#s2-next-btn").click(function(e) {
        e.preventDefault();
        $('html, body').animate({
            scrollTop: $("#s-3").offset().top
        }, 500);
    });

    $("#s3-next-btn").click(function(e) {
        e.preventDefault();
        $('html, body').animate({
            scrollTop: $("#s-4").offset().top
        }, 500);
    });

</script>

</body>
</html>
